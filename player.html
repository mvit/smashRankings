<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <section class="header-wrapper">
      <header>
        <h1> WPI Smash Club Rankings </h1>
      </header>
    </section>
    <section class="nav-wrapper">
      <nav>
        <a href=""> Melee</a>
        <a href="">Smash 4</a>
      </nav>
    </section>
    <section class="content">
      <header>
        <h1 id="title">  </h1>
      </header>
      <section class="chart">
        <svg id="chart" style="float: right;"\>
        <p><span id=score class="big"> </span> - Score <br></p>
        <p><span id=wins class="big"> </span> - Total Wins <br></p>
        <p><span id=losses class="big"> </span> - Total Losses <br></p>
      </section>
    </section>
    <section class="content">
      <h3> Match History </h3>
      <table>
        <thead>
          <tr>
            <th>Tag 1</th>
            <th>Score 1</th>
            <th>Tag 2</th>
            <th>Score 2 </th>
            <th>Day</th>
          </tr>
        </thead>
        <tbody id="match">
        </tbody>
      </table>
    </section>
    <div id=asdf style='text-align: center;'>
    </div>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>


      var getQuery = window.location.search
      //console.log(url)
      //var getQuery = url.split('?')[1]
      console.log(getQuery)
      makeGet('/players' + getQuery);

      function makeGet(url) {
        var req = new XMLHttpRequest();

        req.onreadystatechange = function() {
            handleRes(req);           
          }

        req.open('GET', url);
        req.send();
      }
      
      function handleRes(req) {
        if( req.readyState !== XMLHttpRequest.DONE )
          return;

        if(req.status === 200)
          console.log(req.responseText)
          populateFields( JSON.parse(req.responseText) );
      }     

      function populateFields(playerinfo){
        el = document.getElementById('title');
        el.innerHTML = playerinfo.tag

        el = document.getElementById('score');
        el.innerHTML = playerinfo.score

        el = document.getElementById('wins');
        el.innerHTML = playerinfo.win

        el = document.getElementById('losses');
        el.innerHTML = playerinfo.loss
      }

      var chart = d3.select("chart").style("background-color", "black")

    </script>
    <footer>
      Made by Maurizio Vitale and Jon Sawin for the WPI Smash Club 
    </footer>
  </body>
</html>